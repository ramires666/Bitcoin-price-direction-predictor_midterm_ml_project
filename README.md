# Bitcoin Price Direction Predictor: The Quest for the Crystal Ball üîÆ

Welcome to the **Bitcoin Price Direction Predictor**! This project isn't just another dry financial analysis tool; it's an attempt to engineer a "magic ball" for the cryptocurrency market using advanced machine learning.

## üöÄ The Problem: Taming the Chaos

Cryptocurrency trading is the modern gold rush. It's exciting, volatile, and potentially lucrative. But let's be honest: predicting the exact price of Bitcoin is like trying to herd cats. The market is noisy, chaotic, and constantly changing (non-stationary).

Instead of trying to predict the *exact* price (which is nearly impossible), we asked a simpler question: **Can we predict the DIRECTION?**

If we know whether the next 15-minute candle will be **UP**, **DOWN**, or **SIDEWAYS**, we have an edge. And in trading, an edge is all you need.

## üß† The Solution: Machine Learning & Market Regimes

We built a sophisticated pipeline that moves beyond simple technical analysis:

1.  **"Oracle" Labeling**: We use a zero-lag smoothing technique to define the "true" trend, training our model on what *actually* happened, not just lagging indicators.
2.  **Hidden Markov Models (HMM)**: The market has moods. Sometimes it's a raging bull, sometimes a sleeping bear, and sometimes it's just choppy. We use HMMs to decode these hidden "regimes" and feed them into our predictor.
3.  **XGBoost Classification**: We use a powerful gradient boosting model to synthesize volume, volatility, momentum, and market regimes into a single prediction.

## üõ†Ô∏è Project Structure

*   **`train.py`**: The brain of the operation. Loads data, engineers features (including HMM), trains the XGBoost model, and saves the "brain" to the `models/` directory.
*   **`predict.py`**: The inference engine. Loads the trained model and generates predictions for new data on the fly.
*   **`app.py`**: A FastAPI web service that connects to Binance, fetches live data, caches it in a local database, and serves up fresh predictions.
*   **`midterm_project_bitcoin_price_direction_classificator__prefin.py`**: The research notebook (in script format) detailing the entire journey from data analysis to backtesting.

## ‚ö° How to Run

### Prerequisites

You'll need **Docker** and **Docker Compose** installed. That's it! We've containerized everything for your convenience.

### 1. Get the Data
The project relies on historical data (Parquet files) located in `data/processed/`. These are generated by the scripts in `data/` (e.g., `downloader.py`, `parsing_*.py`). Ensure you have this data before training.

### 2. Train the Model
Before you can predict, you must train. You can do this locally or inside the container.

**Locally (with Conda):**
```bash
conda env create -f environment.yml
conda activate xgb_fints_project
python train.py
```

This will create a `models/` directory with the trained artifacts.

### 3. Launch the Web Service üöÄ
Spin up the prediction service with a single command:

```bash
docker-compose up --build
```

The service will start on **port 11111**.

### 4. Get Predictions!
Open your browser and go to:
üëâ **http://localhost:11111**

You'll see a simple interface. Click **"Update Data & Predict"** to fetch the latest market data from Binance and consult the Oracle.

## üìä Backtesting Results
Our research shows that while regression fails miserably ($R^2 \approx 0$), classification is viable. By filtering for high-confidence setups and understanding market regimes, the model demonstrates predictive power significantly better than a coin flip.

---
*Disclaimer: This is a research project, not financial advice. Trading cryptocurrencies involves significant risk. Use this "magic ball" responsibly!* üòâ