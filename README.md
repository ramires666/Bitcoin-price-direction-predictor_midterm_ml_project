# üîÆ Bitcoin Price Direction Classifier

> "The market is a pendulum that forever swings between unsustainable optimism (which makes stocks too expensive) and unjustified pessimism (which makes them too cheap). The intelligent investor is a realist who sells to optimists and buys from pessimists." - Benjamin Graham

## üìñ Introduction

Trading cryptocurrencies is a high-stakes game that attracts millions with the promise of unlimited upside. But for every winner, there are countless losers. The difference often boils down to one thing: **information**.

Imagine having a "magic ball" that doesn't just guess, but scientifically analyzes the market's hidden states. That's what we've built.

This project isn't just another technical indicator. It's a sophisticated machine learning system that combines:
1.  **"Oracle" Labeling**: We use a zero-lag smoothing technique to define the "true" trend, training our model on what *actually* happened, not just lagging indicators.
2.  **Hidden Markov Models (HMM)**: The market has moods. Sometimes it's a raging bull, sometimes a sleeping bear, and sometimes it's just choppy. We use HMMs to decode these hidden "regimes" and feed them into our predictor.
3.  **XGBoost Classification**: We use a powerful gradient boosting model to synthesize volume, volatility, momentum, and market regimes into a single prediction.

## üõ†Ô∏è Project Structure

*   **`train.py`**: The brain of the operation. Loads data, engineers features (including HMM), trains the XGBoost model, and saves the "brain" to the `models/` directory.
*   **`predict.py`**: The inference engine. Loads the trained model and generates predictions for new data on the fly.
*   **`app.py`**: A FastAPI web service that connects to Binance, fetches live data, caches it in a local database, and serves up fresh predictions.
*   **`midterm_project_bitcoin_price_direction_classificator__prefin.py`**: The research notebook (in script format) detailing the entire journey from data analysis to backtesting.

## ‚ö° How to Run

### Prerequisites

You'll need **Docker** and **Docker Compose** installed. That's it! We've containerized everything for your convenience.

### 1. Get the Data
The project relies on historical data (Parquet files) located in `data/processed/`. These are generated by the scripts in `data/` (e.g., `downloader.py`, `parsing_*.py`). Ensure you have this data before training.

### 2. Train the Model

Before you can predict, you must train. You can do this locally or inside the container.

**Option A: Locally (with Conda)**
```bash
conda env create -f environment.yml
conda activate xgb_fints_project
python train.py
```
*Note: If you encounter OpenMP/KMeans crashes on Windows, try Option B.*

**Option B: Inside Docker (Recommended for Windows)**
If you have issues running locally, you can run the training script inside the Docker container:

1. Build the image:
```bash
docker build -t xgb_fints_project .
```

2. Run the training script (choose your OS):

**Windows (PowerShell):**
```powershell
docker run --rm -v ${PWD}:/app xgb_fints_project python train.py
```

**Windows (Command Prompt):**
```cmd
docker run --rm -v %cd%:/app xgb_fints_project python train.py
```

**Linux / macOS:**
```bash
docker run --rm -v $(pwd):/app xgb_fints_project python train.py
```

This will create a `models/` directory with the trained artifacts (`xgb_hmm_model.joblib`, `scaler.joblib`, etc.).

### 3. Launch the Web Service üöÄ
Spin up the prediction service with a single command:

```bash
docker-compose up --build
```

The service will start on **port 11111**.

### 4. Get Predictions!
Open your browser and go to:
üëâ **http://localhost:11111**

You'll see a simple interface. Click **"Update Data & Predict"** to fetch the latest market data from Binance and consult the Oracle.

## üìä Backtesting Results
Our research shows that while regression fails miserably ($R^2 \approx 0$), classification is viable. By filtering for high-confidence setups and understanding market regimes, the model demonstrates predictive power significantly better than a coin flip.

---
*Disclaimer: This is a research project, not financial advice. Trading cryptocurrencies involves significant risk. Use this "magic ball" responsibly!* üòâ